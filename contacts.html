<!-- contacts.html -->

<body>
    <div id="contacts">Loading...</div>

    <script>
        const hash = new URLSearchParams(window.location.hash.slice(1));
        const token = hash.get('access_token');

        if (!token) {
            document.getElementById('contacts').innerText = 'No token';
        } else {
            fetch(`https://people.googleapis.com/v1/people/me/connections?personFields=names,emailAddresses,phoneNumbers`, {
                headers: { Authorization: `Bearer ${token}` }
            })
                .then(res => res.json())
                .then(data => {
                    const list = data.connections?.map(person => {
                        const name = person.names?.[0]?.displayName || 'No Name';
                        const email = person.emailAddresses?.[0]?.value || '-';
                        const phone = person.phoneNumbers?.[0]?.value || '-';
                        return `<p><strong>${name}</strong>: ${email}, ${phone}</p>`;
                    }).join('');
                    document.getElementById('contacts').innerHTML = list || 'No contacts';
                });
        }
    </script>
</body>